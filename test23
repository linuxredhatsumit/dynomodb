Terrform code some part
provider "aws" {
  region = "ap-south-1"
}

data "local_file" "SAML_IDP_CERT" {
  filename = "SAML_IDP_CERT"
}

data "local_file" "SAML_PRIVATE_KEY" {
  filename = "SAML_PRIVATE_KEY"
}

module "store" {
  source  = "../../../../../../terraform-modules/ssm-parameter-store"
  context = module.this.context
  parameter_write = [
    {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_IDP_CERT_PATH"
      value     = "/mnt/secrets/SAML_IDP_CERT"
      type      = "String"
      overwrite = "true"
    },
    {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_PRIVATE_KEY_PATH"
      value     = "/mnt/secrets/SAML_PRIVATE_KEY"
      type      = "String"
      overwrite = "true"
    },
    {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_IDP_CERT"
      type      = "SecureString"
      value     = "${data.local_file.SAML_IDP_CERT.content}"
      overwrite = "true"
    },
    {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_PRIVATE_KEY"
      type      = "SecureString"
      value     = "${data.local_file.SAML_PRIVATE_KEY.content}"
      overwrite = "true"
    },
      {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_IDP_CERT_BANK_IN"
      type      = "SecureString"
      value     = "${data.local_file.SAML_IDP_CERT.content}"
      overwrite = "true"
    },
    {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_PRIVATE_KEY_BANK_IN"
      type      = "SecureString"
      value     = "${data.local_file.SAML_PRIVATE_KEY.content}"
      overwrite = "true"
    },
        {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_IDP_CERT_PATH_BANK_IN"
      value     = "/mnt/secrets/SAML_IDP_CERT_BANK_IN"
      type      = "String"
      overwrite = "true"
    },
    {
      name      = "/dev/811-CROSSELL/agent-assisted-portal/SAML_PRIVATE_KEY_PATH_BANK_IN"
      value     = "/mnt/secrets/SAML_PRIVATE_KEY_BANK_IN"
      type      = "String"
      overwrite = "true"
    },

  ]
  tags = {
    application-name     = "811_AWS_CROSS_SELL"
    entity               = "KMBL"
    application-id       = "APP-01797"
    application-owner    = "Imran Ansari"
    application-manager  = "Rishav Raj"
    vertical-tlt         = "Amlan Mandal"
    application-rating   = "high"
    ticket-id            = "DEVOPS-4597"
    environment          = "dev"
    project-name         = "811-Crossell"
    Name                 = "agent-portal"
    budget-type          = "rtb"
    monitoring           = "yes"
    db-engine            = "NA"
    created-date         = "09-24-2024"
    instance-node-type   = "NA"
    backup               = "no"
    scheduler-start      = "NA"
    scheduler-stop       = "NA"
    end-date             = "NA"
    created-by-terraform = "yes"
    terraform-version    = "1.4.6"
    resource-name        = "ssm-dev-agent-portal"
    project-811          = "CROSSELL"
  }
}

terraform {
  backend "s3" {
    bucket         = "kotak811-terraform-state"
    key            = "kotak811/env/kotak811-dev/ssm/crossell-dev/agent-assisted-portal/ssm.tfstate"
    region         = "ap-south-1"
    dynamodb_table = "tf-up-and-run-locks"
    encrypt        = true
  }
}


helm chart templates secrets
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: {{ .Chart.Name }}-spc
  namespace: {{ .Values.namespace }}
spec:
  provider: aws
  secretObjects:
    - secretName: {{ .Chart.Name }}-secrets
      type: Opaque
      data:
        - objectName: SAML_IDP_CERT
          key: SAML_IDP_CERT
        - objectName: SAML_PRIVATE_KEY
          key: SAML_PRIVATE_KEY       
        - objectName: SAML_IDP_CERT_PATH
          key: SAML_IDP_CERT_PATH
        - objectName: SAML_PRIVATE_KEY_PATH
          key: SAML_PRIVATE_KEY_PATH
        - objectName: SAML_IDP_CERT_BANK_IN
          key: SAML_IDP_CERT_BANK_IN
        - objectName: SAML_PRIVATE_KEY_BANK_IN
          key: SAML_PRIVATE_KEY_BANK_IN    
        - objectName: SAML_IDP_CERT_PATH_BANK_IN
          key: SAML_IDP_CERT_PATH_BANK_IN
        - objectName: SAML_PRIVATE_KEY_PATH_BANK_IN
          key: SAML_PRIVATE_KEY_PATH_BANK_IN
  parameters:
    objects: |
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_IDP_CERT"
        objectType: "ssmparameter"
        objectAlias: SAML_IDP_CERT
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_PRIVATE_KEY"
        objectType: "ssmparameter"
        objectAlias: SAML_PRIVATE_KEY
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_IDP_CERT_PATH"
        objectType: "ssmparameter"
        objectAlias: SAML_IDP_CERT_PATH
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_PRIVATE_KEY_PATH"
        objectType: "ssmparameter"
        objectAlias: SAML_PRIVATE_KEY_PATH
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_IDP_CERT_PATH_BANK_IN"
        objectType: "ssmparameter"
        objectAlias: SAML_IDP_CERT_PATH_BANK_IN
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_PRIVATE_KEY_PATH_BANK_IN"
        objectType: "ssmparameter"
        objectAlias: SAML_PRIVATE_KEY_PATH_BANK_IN
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_IDP_CERT_BANK_IN"
        objectType: "ssmparameter"
        objectAlias: SAML_IDP_CERT_BANK_IN
      - objectName: "/{{ .Values.ssmParameter.ssm_root }}/811-CROSSELL/{{ .Values.ssmParameter.service_name }}/SAML_PRIVATE_KEY_BANK_IN"
        objectType: "ssmparameter"
        objectAlias: SAML_PRIVATE_KEY_BANK_IN


pipeline error

  File "/opt/pysetup/.venv/lib/python3.10/site-packages/django/urls/resolvers.py", line 715, in url_patterns
    patterns = getattr(self.urlconf_module, "urlpatterns", self.urlconf_module)
  File "/opt/pysetup/.venv/lib/python3.10/site-packages/django/utils/functional.py", line 57, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
  File "/opt/pysetup/.venv/lib/python3.10/site-packages/django/urls/resolvers.py", line 708, in urlconf_module
    return import_module(self.urlconf_name)
  File "/usr/local/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/k811/app/agentassistedportal/urls_public.py", line 25, in <module>
    import customer.views.agent_customer_search
  File "/k811/app/customer/views/agent_customer_search.py", line 19, in <module>
    from agentassistedportal import settings
  File "/k811/app/agentassistedportal/settings/__init__.py", line 38, in <module>
    from agentassistedportal.saml import *  # noqa: F403
  File "/k811/app/agentassistedportal/saml.py", line 174, in <module>
    "key_file": env.str("SAML_PRIVATE_KEY_PATH_BANK_IN"),
  File "/opt/pysetup/.venv/lib/python3.10/site-packages/environ/environ.py", line 212, in str
    value = self.get_value(var, cast=str, default=default)
  File "/opt/pysetup/.venv/lib/python3.10/site-packages/environ/environ.py", line 391, in get_value
    raise ImproperlyConfigured(error_msg) from exc
django.core.exceptions.ImproperlyConfigured: Set the SAML_PRIVATE_KEY_PATH_BANK_IN environment variable

Finishing: Application Status
