#!/bin/bash

echo "üîç Scanning for global tables with ap-south-2 replica..."

for table in $(aws dynamodb list-tables \
  --region ap-south-1 \
  --no-verify-ssl \
  --output text \
  --query "TableNames[]"); do

  echo "Checking table: $table"

  if aws dynamodb describe-table \
    --region ap-south-1 \
    --no-verify-ssl \
    --table-name "$table" \
    --query "Table.Replicas[*].RegionName" \
    --output text | grep -q "ap-south-2"; then

    echo "‚úÖ Found Global Table with ap-south-2 replica: $table"
  fi
done