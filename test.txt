
          + "application-id"       = "APP-01783"
          + "application-manager"  = "Ram Singh"
          + "application-name"     = "811 Onboarding App"
          + "application-owner"    = "Amlan Mandal"
          + "created-by-terraform" = "yes"
          + "created-date"         = "07-17-2025"
          + "entity"               = "KMBL"
          + "environment"          = "prod"
          + "project-811"          = "ONB"
          + "project-name"         = "811-ONB"
          + "scheduler-start"      = "NA"
          + "scheduler-stop"       = "NA"
          + "ticket-id"            = "DEVOPS-7685"
          + "vertical-tlt"         = "Amlan Mandal"
        }
      + unique_id             = (known after apply)
        # (1 unchanged attribute hidden)

      + inline_policy (known after apply)
    }

  # module.secondary_api_gateway[0].module.cloudwatch_log_group.module.role.aws_iam_role_policy_attachment.default[0] will be created
  + resource "aws_iam_role_policy_attachment" "default" {
      + id         = (known after apply)
      + policy_arn = (known after apply)
      + role       = "k811-finbridge-connector-api-gw-prod-dr-log-group"
    }

Plan: 41 to add, 0 to change, 0 to destroy.
╷
│ Error: Invalid provider configuration
│ 
│ Provider "registry.terraform.io/hashicorp/aws" requires explicit
│ configuration. Add a provider block to the root module and configure the
│ provider's required arguments as described in the provider documentation.
│ 
╵
╷
│ Error: invalid AWS Region: 
│ 
│   with provider["registry.terraform.io/hashicorp/aws"],
│   on <empty> line 0:
│   (source code not available)
│ 


getting above error below is my api.tf
########################################
# API Gateway Module for primary region
########################################
module "primary_api_gateway" {
    count            = var.api_gateway_details != null ? 1 : 0
    source           = "git::https://kmbl-devops@dev.azure.com/kmbl-devops/kotak811-devops-codebase/_git/k811-terraform-modules//modules/apigateway?ref=v1.0.0"
    providers        = { aws = aws.primary }
    name             = "k811-${var.k811_service_name}-api-gw-${local.env}"
    stage_name       = var.api_gateway_details["stage_name"]
    endpoint_type    = "PRIVATE"
    vpc_endpoint_ids = local.primary_vpc_endpoint
    body = jsonencode({
    openapi = "3.0.1"
    info = {
        title   = "initialdeployment"
        version = "1.0"
    }
    paths = {
        "/path1" = {
        get = {
            x-amazon-apigateway-integration = {
            httpMethod           = "GET"
            payloadFormatVersion = "1.0"
            type                 = "HTTP_PROXY"
            uri                  = "https://ip-ranges.amazonaws.com/ip-ranges.json"
            }
        }
        }
    }
    })
    endpoint_configuration = {
    disable_execute_api_endpoint = true
    types                        = "PRIVATE"
    vpc_endpoint_ids             = local.primary_vpc_endpoint
    }
    context              = module.this.context
    logging_level        = "INFO"
    metrics_enabled      = false
    xray_tracing_enabled = false
    data_trace_enabled   = true
    rest_api_policy      = <<EOF
    {
    "Version": "2012-10-17",
    "Statement": [
    {
        "Effect": "Allow",
        "Principal": {
        "AWS": "*"
        },
        "Action": "execute-api:Invoke",
        "Resource": "${module.primary_api_gateway[0].execution_arn}/*"
    },
        {
            "Effect": "Deny",
            "Principal": "*",
            "Action": "execute-api:Invoke",
            "Resource": [
                "execute-api:/*"
            ],
            "Condition" : {
                "StringNotEquals": {
                    "aws:SourceVpce": "${local.primary_vpc_endpoint}"
                }
            }
        }
    ]
    }
    EOF
    access_log_format = <<EOF
    {
    "requestTime": "$context.requestTime",
    "requestId": "$context.requestId",
    "httpMethod": "$context.httpMethod",
    "path": "$context.path",
    "resourcePath": "$context.resourcePath",
    "status": $context.status,
    "responseLatency": $context.responseLatency,
    "xrayTraceId": "$context.xrayTraceId",
    "integrationRequestId": "$context.integration.requestId",
    "functionResponseStatus": "$context.integration.status",
    "integrationLatency": "$context.integration.latency",
    "integrationServiceStatus": "$context.integration.integrationStatus",
    "authorizeResultStatus": "$context.authorize.status",
    "authorizerServiceStatus": "$context.authorizer.status",
    "authorizerLatency": "$context.authorizer.latency",
    "authorizerRequestId": "$context.authorizer.requestId",
    "ip": "$context.identity.sourceIp",
    "userAgent": "$context.identity.userAgent",
    "principalId": "$context.authorizer.principalId",
    "cognitoUser": "$context.identity.cognitoIdentityId",
    "user": "$context.identity.user"
    }
    EOF
}

##########################################
# API Gateway Module for secondary region
##########################################
module "secondary_api_gateway" {
    count            = var.api_gateway_details != null && var.create_in_secondary ? 1 : 0
    source           = "git::https://kmbl-devops@dev.azure.com/kmbl-devops/kotak811-devops-codebase/_git/k811-terraform-modules//modules/apigateway?ref=v1.0.0"
    providers        = { aws = aws.secondary }
    name             = "k811-${var.k811_service_name}-api-gw-${local.env}-dr"
    stage_name       = var.api_gateway_details["stage_name"]
    endpoint_type    = "PRIVATE"
    vpc_endpoint_ids = local.secondary_vpc_endpoint
    body = jsonencode({
    openapi = "3.0.1"
    info = {
        title   = "initialdeployment"
        version = "1.0"
    }
    paths = {
        "/path1" = {
        get = {
            x-amazon-apigateway-integration = {
            httpMethod           = "GET"
            payloadFormatVersion = "1.0"
            type                 = "HTTP_PROXY"
            uri                  = "https://ip-ranges.amazonaws.com/ip-ranges.json"
            }
        }
        }
    }
    })
    endpoint_configuration = {
    disable_execute_api_endpoint = true
    types                        = "PRIVATE"
    vpc_endpoint_ids             = local.secondary_vpc_endpoint
    }
    context              = module.this.context
    logging_level        = "INFO"
    metrics_enabled      = false
    xray_tracing_enabled = false
    data_trace_enabled   = true
    rest_api_policy      = <<EOF
    {
    "Version": "2012-10-17",
    "Statement": [
    {
        "Effect": "Allow",
        "Principal": {
        "AWS": "*"
        },
        "Action": "execute-api:Invoke",
        "Resource": "${module.secondary_api_gateway[0].execution_arn}/*"
    },
        {
            "Effect": "Deny",
            "Principal": "*",
            "Action": "execute-api:Invoke",
            "Resource": [
                "execute-api:/*"
            ],
            "Condition" : {
                "StringNotEquals": {
                    "aws:SourceVpce": "${local.secondary_vpc_endpoint}"
                }
            }
        }
    ]
    }
    EOF
    access_log_format = <<EOF
    {
    "requestTime": "$context.requestTime",
    "requestId": "$context.requestId",
    "httpMethod": "$context.httpMethod",
    "path": "$context.path",
    "resourcePath": "$context.resourcePath",
    "status": $context.status,
    "responseLatency": $context.responseLatency,
    "xrayTraceId": "$context.xrayTraceId",
    "integrationRequestId": "$context.integration.requestId",
    "functionResponseStatus": "$context.integration.status",
    "integrationLatency": "$context.integration.latency",
    "integrationServiceStatus": "$context.integration.integrationStatus",
    "authorizeResultStatus": "$context.authorize.status",
    "authorizerServiceStatus": "$context.authorizer.status",
    "authorizerLatency": "$context.authorizer.latency",
    "authorizerRequestId": "$context.authorizer.requestId",
    "ip": "$context.identity.sourceIp",
    "userAgent": "$context.identity.userAgent",
    "principalId": "$context.authorizer.principalId",
    "cognitoUser": "$context.identity.cognitoIdentityId",
    "user": "$context.identity.user"
    }
    EOF
}

#####################################################
# APIGW CUSTOM DOMAIN NAME Mapping for primary rgion
#####################################################
resource "aws_apigatewayv2_api_mapping" "primary_api_gw_mapping" {
    for_each        = try(var.api_gateway_details["primary_custom_domains"], {}) 
    provider        = aws.primary
    api_id          = module.primary_api_gateway[0].id
    domain_name     = each.value["name"]
    stage           = var.api_gateway_details["stage_name"]
    api_mapping_key = each.value["key"]
    depends_on      = [ module.primary_api_gateway[0]]
}

########################################################
# APIGW CUSTOM DOMAIN NAME Mapping for secondary region
########################################################
resource "aws_apigatewayv2_api_mapping" "secondary_api_gw_mapping" {
    for_each        = try(var.api_gateway_details["secondary_custom_domains"], {})
    provider        = aws.secondary
    api_id          = module.secondary_api_gateway[0].id
    domain_name     = each.value["name"]
    stage           = var.api_gateway_details["stage_name"]
    api_mapping_key = each.value["key"]
    depends_on      = [ module.secondary_api_gateway[0]]
}

##########
# API key
##########
resource "random_password" "api_key" {
    count   = try(var.api_gateway_details["create_key_authorizer"], false) == true ? 1 : 0
    length  = 25
    special = false
}

#############################################################
# APIGW Key based authorizer + Usage Plan for primary region
#############################################################
resource "aws_api_gateway_usage_plan" "primary_usage_plan" {
    count    = try(var.api_gateway_details["create_key_authorizer"], false) == true ? 1 : 0
    provider = aws.primary
    name     = "k811-${var.k811_service_name}-usage-plan-${local.env}"
    api_stages {
        api_id = module.primary_api_gateway[0].id
        stage  = var.api_gateway_details["stage_name"]
    }
    depends_on = [ module.primary_api_gateway[0] ]
}

resource "aws_api_gateway_api_key" "primary_api_key" {
    count    = try(var.api_gateway_details["create_key_authorizer"], false) == true ? 1 : 0
    provider = aws.primary
    name     = "k811-${var.k811_service_name}-api-key-${local.env}"
    value    = random_password.api_key[0].result
    tags     = {
        Name          = "k811-${var.k811_service_name}-api-key-${local.env}"
        resource-name = "k811-${var.k811_service_name}-api-key-${local.env}"
    }
}

resource "aws_api_gateway_usage_plan_key" "primary_usage_plan_api_key" {
    count         = try(var.api_gateway_details["create_key_authorizer"], false) == true ? 1 : 0
    provider      = aws.primary
    key_id        = aws_api_gateway_api_key.primary_api_key[0].id
    key_type      = "API_KEY"
    usage_plan_id = aws_api_gateway_usage_plan.primary_usage_plan[0].id
}
###############################################################
# APIGW Key based authorizer + Usage Plan for secondary region
###############################################################
resource "aws_api_gateway_usage_plan" "secondary_usage_plan" {
    count    = try(var.api_gateway_details["create_key_authorizer"], false) && var.create_in_secondary == true ? 1 : 0
    provider = aws.secondary
    name     = "k811-${var.k811_service_name}-usage-plan-${local.env}"
    api_stages {
        api_id = module.secondary_api_gateway[0].id
        stage  = var.api_gateway_details["stage_name"]
    }
    depends_on = [ module.secondary_api_gateway[0] ]
}

resource "aws_api_gateway_api_key" "secondary_api_key" {
    count    = try(var.api_gateway_details["create_key_authorizer"], false) && var.create_in_secondary == true ? 1 : 0
    provider = aws.secondary
    name     = "k811-${var.k811_service_name}-api-key-${local.env}"
    value    = random_password.api_key[0].result
    tags     = {
        Name          = "k811-${var.k811_service_name}-api-key-${local.env}"
        resource-name = "k811-${var.k811_service_name}-api-key-${local.env}"
    }
}

resource "aws_api_gateway_usage_plan_key" "secondary_usage_plan_key" {
    count         = try(var.api_gateway_details["create_key_authorizer"], false) && var.create_in_secondary == true ? 1 : 0
    provider      = aws.secondary
    key_id        = aws_api_gateway_api_key.secondary_api_key[0].id
    key_type      = "API_KEY"
    usage_plan_id = aws_api_gateway_usage_plan.secondary_usage_plan[0].id
}

###########################################################################
# Custom Authorizer + Trigger for Api to Cognito Lambda for primary region
###########################################################################
resource "aws_api_gateway_authorizer" "primary_custom_authorizer" {
    count                            = try(var.api_gateway_details["create_custom_authorizer"], false) == true ? 1 : 0
    provider                         = aws.primary
    name                             = local.primary_custom_authorizer_name
    rest_api_id                      = module.primary_api_gateway[0].id
    type                             = "REQUEST"
    identity_validation_expression   = "^(Bearer )[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)$"
    identity_source                  = "method.request.header.Authorization"
    authorizer_uri                   = "arn:aws:apigateway:${local.primary_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${local.primary_region}:${local.account_id}:function:${local.primary_custom_authorizer_lambda_name}/invocations"
    authorizer_result_ttl_in_seconds = "60"
}

resource "aws_lambda_permission" "primary_lambda_permission" {
    count         = try(var.api_gateway_details["create_custom_authorizer"], false) == true ? 1 : 0
    provider      = aws.primary
    action        = "lambda:InvokeFunction"
    function_name = local.primary_custom_authorizer_lambda_name
    principal     = "apigateway.amazonaws.com"
    source_arn    = "${module.primary_api_gateway[0].execution_arn}/authorizers/${aws_api_gateway_authorizer.primary_custom_authorizer[count.index].id}"
    depends_on    = [ aws_api_gateway_authorizer.primary_custom_authorizer[0] ]
}

#############################################################################
# Custom Authorizer + Trigger for Api to Cognito Lambda for secondary region
#############################################################################
resource "aws_api_gateway_authorizer" "secondary_custom_authorizer" {
    count                            = try(var.api_gateway_details["create_custom_authorizer"], false) && var.create_in_secondary == true ? 1 : 0
    provider                         = aws.secondary
    name                             = local.secondary_custom_authorizer_name
    rest_api_id                      = module.secondary_api_gateway[0].id
    type                             = "REQUEST"
    identity_validation_expression   = "^(Bearer )[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)$"
    identity_source                  = "method.request.header.Authorization"
    authorizer_uri                   = "arn:aws:apigateway:${local.secondary_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${local.secondary_region}:${local.account_id}:function:${local.secondary_custom_authorizer_lambda_name}/invocations"
    authorizer_result_ttl_in_seconds = "60"
}

resource "aws_lambda_permission" "secondary_lambda_permission" {
    count         = try(var.api_gateway_details["create_custom_authorizer"], false) && var.create_in_secondary == true ? 1 : 0
    provider      = aws.secondary
    action        = "lambda:InvokeFunction"
    function_name = local.secondary_custom_authorizer_lambda_name
    principal     = "apigateway.amazonaws.com"
    source_arn    = "${module.secondary_api_gateway[0].execution_arn}/authorizers/${aws_api_gateway_authorizer.secondary_custom_authorizer[count.index].id}"
    depends_on    = [ aws_api_gateway_authorizer.secondary_custom_authorizer[0] ]
}

###############################################################################
# SCC Custom Authorizer + Trigger for Api to Cognito Lambda for primary region
###############################################################################
resource "aws_api_gateway_authorizer" "primary_scc_custom_authorizer" {
    count                            = try(var.api_gateway_details["create_scc_authorizer"], false) ? 1 : 0
    provider                         = aws.primary
    name                             = local.primary_custom_authorizer_name
    rest_api_id                      = module.primary_api_gateway[0].id
    type                             = "REQUEST"
    identity_source                  = "method.request.header.Authorization"
    authorizer_uri                   = "arn:aws:apigateway:${local.primary_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${local.primary_region}:${local.account_id}:function:${local.primary_scc_authorizer_lambda_name}/invocations"
    authorizer_result_ttl_in_seconds = "60"
}
resource "aws_lambda_permission" "primary_lambda_permission_scc" {
    count         = try(var.api_gateway_details["create_scc_authorizer"], false) ? 1 : 0
    provider      = aws.primary
    action        = "lambda:InvokeFunction"
    function_name = local.primary_scc_authorizer_lambda_name
    principal     = "apigateway.amazonaws.com"
    source_arn    = "${module.primary_api_gateway[0].execution_arn}/authorizers/${aws_api_gateway_authorizer.primary_scc_custom_authorizer[count.index].id}"
    depends_on    = [ aws_api_gateway_authorizer.primary_scc_custom_authorizer[0] ]
}

#################################################################################
# SCC Custom Authorizer + Trigger for Api to Cognito Lambda for secondary region
#################################################################################
resource "aws_api_gateway_authorizer" "secondary_scc_custom_authorizer" {
    count                            = try(var.api_gateway_details["create_scc_authorizer"], false) && var.create_in_secondary == true ? 1 : 0
    provider                         = aws.secondary
    name                             = local.secondary_custom_authorizer_name
    rest_api_id                      = module.secondary_api_gateway[0].id
    type                             = "REQUEST"
    identity_source                  = "method.request.header.Authorization"
    authorizer_uri                   = "arn:aws:apigateway:${local.secondary_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${local.secondary_region}:${local.account_id}:function:${local.secondary_scc_authorizer_lambda_name}/invocations"
    authorizer_result_ttl_in_seconds = "60"
}
resource "aws_lambda_permission" "secondary_lambda_permission_scc" {
    count         = try(var.api_gateway_details["create_scc_authorizer"], false) && var.create_in_secondary == true ? 1 : 0
    provider                         = aws.secondary
    action        = "lambda:InvokeFunction"
    function_name = local.secondary_scc_authorizer_lambda_name
    principal     = "apigateway.amazonaws.com"
    source_arn    = "${module.secondary_api_gateway[0].execution_arn}/authorizers/${aws_api_gateway_authorizer.secondary_scc_custom_authorizer[count.index].id}"
    depends_on    = [ aws_api_gateway_authorizer.secondary_scc_custom_authorizer[0] ]
}

let me know if u need any otehr TF file the check the error 
